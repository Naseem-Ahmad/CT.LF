@{
    ViewBag.Title = "Home Page";
}

<main>
    <h2>Location  Finder App</h2>
    <ul>
        <li>FrontEnd: Razor page
        <li>BackEnd: C#
        <li>ORM    : Entity Framework
        <li>Pattern: MVC
        <li>Database: SQL
    </ul>
    @{
        ViewBag.Title = "Get Location on Click";
    }

    <h2>Get Location Example</h2>

    <button id="find-me">Show my location</button><br />
    <p id="status"></p>
    <a id="map-link" target="_blank"></a>

    @*<script>
            function geoFindMe() {
                const status = document.querySelector("#status");
                const mapLink = document.querySelector("#map-link");

                mapLink.href = "";
                mapLink.textContent = "";

                function success(position) {
                    const latitude = position.coords.latitude;
                    const longitude = position.coords.longitude;

                    status.textContent = "";
                    mapLink.href = `https://www.openstreetmap.org/#map=18/${latitude}/${longitude}`;
                    mapLink.textContent = `Latitude: ${latitude} °, Longitude: ${longitude} °`;
                }

                function error() {
                    status.textContent = "Unable to retrieve your location";
                }

                if (!navigator.geolocation) {
                    status.textContent = "Geolocation is not supported by your browser";
                } else {
                    status.textContent = "Locating…";
                    navigator.geolocation.getCurrentPosition(success, error);
                }
            }

            document.querySelector("#find-me").addEventListener("click", geoFindMe);
        </script>*@

    <script>
        function geoFindMe() {
            const status = document.querySelector("#status");
            const mapLink = document.querySelector("#map-link");

            mapLink.href = "";
            mapLink.textContent = "";

            function success(position) {
                const latitude = position.coords.latitude;
                const longitude = position.coords.longitude;
                const accuracy = position.coords.accuracy;

                status.textContent = `Accuracy: ±${accuracy} meters`;
                mapLink.href = `https://www.openstreetmap.org/#map=18/${latitude}/${longitude}`;
                mapLink.textContent = `Latitude: ${latitude}°, Longitude: ${longitude}°`;
            }

            function error() {
                status.textContent = "Unable to retrieve your location";
            }

            if (!navigator.geolocation) {
                status.textContent = "Geolocation is not supported by your browser";
            } else {
                status.textContent = "Locating… (please allow location access)";
                navigator.geolocation.getCurrentPosition(success, error, {
                    enableHighAccuracy: true,   // ✅ ask for GPS-level precision
                    timeout: 10000,             // wait up to 10s
                    maximumAge: 0               // don't use cached data
                });
            }
        }

        document.querySelector("#find-me").addEventListener("click", geoFindMe);
    </script>

</main>
    @Html.AntiForgeryToken()




